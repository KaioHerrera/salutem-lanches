<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="mb-0">Gerenciamento de Ingredientes</h2>
  </div>

  <!-- Formulário -->
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-success text-white">
      <h5 class="mb-0">
        <i class="bi bi-plus-circle me-2"></i>
        {{ modoEdicao ? 'Editar Ingrediente' : 'Novo Ingrediente' }}
      </h5>
    </div>
    <div class="card-body">
      <form (ngSubmit)="salvarIngrediente()" #ingredienteForm="ngForm">
        <div class="row g-3">
          <div class="col-md-3">
            <label class="form-label fw-bold">Código</label>
            <input
              type="text"
              class="form-control bg-light"
              [value]="ingrediente.codigo"
              readonly
              style="cursor: not-allowed"
            />
            <small class="text-muted">Gerado automaticamente</small>
          </div>

          <div class="col-md-5">
            <label class="form-label fw-bold">Descrição *</label>
            <input
              type="text"
              class="form-control"
              [(ngModel)]="ingrediente.descricao"
              name="descricao"
              required
              placeholder="Ex: Queijo Cheddar"
            />
          </div>

          <div class="col-md-2">
            <label class="form-label fw-bold">Preço *</label>
            <div class="input-group">
              <span class="input-group-text">R$</span>
              <input
                type="number"
                step="0.01"
                class="form-control"
                [(ngModel)]="ingrediente.precoUnitario"
                name="precoUnitario"
                required
                placeholder="0.00"
              />
            </div>
          </div>

          <div class="col-md-2">
            <label class="form-label fw-bold">É Adicional?</label>
            <div class="form-check mt-2">
              <input
                type="checkbox"
                class="form-check-input"
                [(ngModel)]="ingrediente.ehAdicional"
                name="ehAdicional"
                id="adicionalCheck"
              />
              <label class="form-check-label" for="adicionalCheck"> Pode ser adicional </label>
            </div>
          </div>
        </div>

        <div class="mt-4">
          <button
            type="submit"
            class="btn btn-success me-2"
            [disabled]="!ingredienteForm.form.valid"
          >
            <i class="bi bi-check-circle me-1"></i>
            {{ modoEdicao ? 'Atualizar' : 'Salvar' }}
          </button>
          <button type="button" class="btn btn-secondary" (click)="limparFormulario()">
            <i class="bi bi-x-circle me-1"></i>
            Cancelar
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Pesquisa -->
  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <div class="row">
        <div class="col-md-6">
          <label class="form-label fw-bold">Pesquisar Ingredientes</label>
          <div class="input-group">
            <input
              type="text"
              class="form-control"
              placeholder="Digite código ou descrição..."
              [(ngModel)]="termoPesquisa"
            />
            <button
              class="btn btn-outline-success"
              (click)="pesquisarIngredientes()"
              [disabled]="!termoPesquisa.trim()"
            >
              <i class="bi bi-search me-1"></i>
              Pesquisar
            </button>
            <button class="btn btn-outline-secondary" (click)="carregarIngredientes()">
              <i class="bi bi-list-ul me-1"></i>
              Todos
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Lista de Ingredientes -->
  <div class="card shadow-sm">
    <div class="card-header bg-light">
      <h5 class="mb-0">
        <i class="bi bi-list-check me-2"></i>
        Lista de Ingredientes
        <span class="badge bg-success ms-2">{{ ingredientes.length }}</span>
      </h5>
    </div>
    <div class="card-body">
      <div *ngIf="ingredientes.length === 0" class="text-center py-4">
        <div class="text-muted">
          <i class="bi bi-egg-fried fs-1"></i>
          <p class="mt-2">Nenhum ingrediente cadastrado</p>
          <small>Use o formulário acima para cadastrar o primeiro ingrediente</small>
        </div>
      </div>

      <div *ngIf="ingredientes.length > 0" class="table-responsive">
        <table class="table table-hover">
          <thead class="table-dark">
            <tr>
              <th>Código</th>
              <th>Descrição</th>
              <th>Preço</th>
              <th>Adicional</th>
              <th width="150">Ações</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let ingrediente of ingredientes">
              <td class="fw-bold">{{ ingrediente.codigo }}</td>
              <td>{{ ingrediente.descricao }}</td>
              <td class="fw-bold text-success">R$ {{ ingrediente.precoUnitario.toFixed(2) }}</td>
              <td>
                <span
                  class="badge"
                  [ngClass]="ingrediente.ehAdicional ? 'bg-info' : 'bg-secondary'"
                >
                  {{ ingrediente.ehAdicional ? 'Sim' : 'Não' }}
                </span>
              </td>
              <td>
                <div class="btn-group btn-group-sm">
                  <button
                    class="btn btn-outline-primary"
                    (click)="editarIngrediente(ingrediente)"
                    title="Editar"
                  >
                    <i class="bi bi-pencil"></i>
                  </button>
                  <button
                    class="btn btn-outline-danger"
                    (click)="excluirIngrediente(ingrediente.id!)"
                    title="Excluir"
                  >
                    <i class="bi bi-trash"></i>
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
